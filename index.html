<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Snake - Mobile Swipe</title>

<style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
    *{box-sizing:border-box; user-select:none; -webkit-user-select:none;}
    body{
        margin:0;
        height:100vh;
        display:flex;
        flex-direction:column;
        justify-content:center;
        align-items:center;
        background:#000;
        font-family:'Orbitron',sans-serif;
        overflow:hidden;
    }

    h1{
        margin:10px 0;
        font-size:6vw;
        color:#ffd700;
        text-shadow:0 0 20px #ffd700;
    }

    #game-container{
        position:relative;
        width:100vw;
        height:100vh;
        display:flex;
        justify-content:center;
        align-items:center;
    }

    canvas{
        width:100vw;
        height:100vh;
        background:#000;
        touch-action:none;
    }

    #score{
        position:absolute;
        top:10px;
        left:50%;
        transform:translateX(-50%);
        background:rgba(0,0,0,0.6);
        padding:10px 25px;
        border-radius:50px;
        font-size:4vw;
        color:#ffd700;
        border:2px solid #ffd700;
        text-shadow:0 0 10px gold;
        z-index:20;
    }

    #start-screen,#game-over,#pause,#leaderboard{
        position:absolute;
        top:50%;
        left:50%;
        transform:translate(-50%,-50%);
        background:rgba(0,0,0,0.9);
        padding:40px 70px;
        border-radius:25px;
        font-size:7vw;
        color:#ffd700;
        border:3px solid #ffd700;
        text-shadow:0 0 15px #ffd700;
        text-align:center;
        z-index:30;
    }

    small{
        font-size:4vw;
        display:block;
        margin-top:20px;
    }

    #game-over{
        color:#ff3333;
        border-color:#ff3333;
        text-shadow:0 0 15px red;
    }
</style>
</head>
<body>

<div id="game-container">
    <div id="score">Muz: 0 | En Yüksek: 0</div>
    <canvas id="gameCanvas"></canvas>

    <div id="start-screen">
        HAZIR MISIN?
        <small>Başlamak için DOKUN</small>
    </div>

    <div id="game-over" style="display:none">
        OYUN BİTTİ!
        <small>Yeniden başlamak için dokun</small>
    </div>

    <div id="pause" style="display:none">
        DURDURULDU
        <small>Devam etmek için dokun</small>
    </div>

    <div id="leaderboard" style="display:none"></div>
</div>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");
const scoreEl = document.getElementById("score");
const startScreen = document.getElementById("start-screen");
const gameOverEl = document.getElementById("game-over");

let GRID = 30;
let CELL;
let snake, dx, dy, food, score, highScore;
let speed, gameRunning, paused, lastMove;

function resizeCanvas(){
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;
    CELL = canvas.width / GRID;
}
window.onresize = resizeCanvas;
resizeCanvas();

function resetGame(){
    snake = [
        {x:15,y:15},{x:14,y:15},{x:13,y:15},
        {x:12,y:15},{x:11,y:15}
    ];
    dx = 1; dy = 0;
    score = 0;
    highScore = parseInt(localStorage.getItem("snakeHS")) || 0;
    speed = 110;
    gameRunning = true;
    paused = false;
    spawnFood();
    updateScore();
    lastMove = performance.now();
    requestAnimationFrame(loop);
}

function spawnFood(){
    do{
        food = {
            x:Math.floor(Math.random()*GRID),
            y:Math.floor(Math.random()*GRID)
        };
    }while(snake.some(s=>s.x===food.x && s.y===food.y));
}

function updateScore(){
    scoreEl.textContent = `Muz: ${score} | En Yüksek: ${highScore}`;
}

function gameOver(){
    gameRunning = false;
    if(score > highScore){
        highScore = score;
        localStorage.setItem("snakeHS", highScore);
    }
    updateScore();
    gameOverEl.style.display = "block";
}

function loop(time){
    if(!gameRunning) return;

    if(time - lastMove > speed){
        const head = {x: snake[0].x + dx, y: snake[0].y + dy};

        if(head.x < 0 || head.x >= GRID || head.y < 0 || head.y >= GRID){
            gameOver(); return;
        }
        if(snake.slice(1).some(p=>p.x===head.x && p.y===head.y)){
            gameOver(); return;
        }

        if(head.x === food.x && head.y === food.y){
            score++;
            updateScore();
            spawnFood();
        } else {
            snake.pop();
        }

        snake.unshift(head);
        lastMove = time;
    }

    ctx.fillStyle = "#000";
    ctx.fillRect(0,0,canvas.width,canvas.height);

    // Food
    ctx.fillStyle = "#ffdd44";
    ctx.fillRect(food.x*CELL, food.y*CELL, CELL, CELL);

    // Snake
    ctx.fillStyle = "#00ff00";
    snake.forEach(p=>{
        ctx.fillRect(p.x*CELL, p.y*CELL, CELL, CELL);
    });

    requestAnimationFrame(loop);
}

// Touch Swipe Controls
let touchStartX = 0;
let touchStartY = 0;

canvas.addEventListener("touchstart", e=>{
    const t = e.touches[0];
    touchStartX = t.clientX;
    touchStartY = t.clientY;

    if(!gameRunning){
        startScreen.style.display = "none";
        gameOverEl.style.display = "none";
        resetGame();
    }
});

canvas.addEventListener("touchmove", e=>{
    e.preventDefault();
    const t = e.touches[0];
    const dxSwipe = t.clientX - touchStartX;
    const dySwipe = t.clientY - touchStartY;

    if(Math.abs(dxSwipe) > Math.abs(dySwipe)){
        if(dxSwipe > 20 && dx !== -1){ dx = 1; dy = 0; }
        if(dxSwipe < -20 && dx !== 1){ dx = -1; dy = 0; }
    } else {
        if(dySwipe > 20 && dy !== -1){ dx = 0; dy = 1; }
        if(dySwipe < -20 && dy !== 1){ dx = 0; dy = -1; }
    }
});

updateScore();
</script>
</body>
</html>
