<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Yƒ±lan Muz - Mobil</title>
    <link rel="manifest" href="data:application/manifest+json,{
        'name': 'Yƒ±lan Muz Oyunu',
        'short_name': 'SnakeMuz',
        'start_url': '.',
        'display': 'fullscreen',
        'background_color': '#0d1b2a',
        'theme_color': '#ffd700',
        'icons': [{'src': 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTkyIiBoZWlnaHQ9IjE5MiIgZmlsbD0iI2ZmZDcwMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48Y2lyY2xlIGN4PSI5NiIgY3k9IjEwNCIgcj0iNzYiLz48L3N2Zz4=', 'sizes': '192x192', 'type': 'image/svg+xml'}]
    }">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');
        *{margin:0;padding:0;box-sizing:border-box;touch-action:none;-webkit-user-select:none;-webkit-tap-highlight-color:transparent}
        body{height:100vh;display:flex;justify-content:center;align-items:center;background:linear-gradient(135deg,#0d1b2a,#1b263b);font-family:'Orbitron',sans-serif;color:#e0e1dd;flex-direction:column;overflow:hidden}
        h1{margin:0 0 10px;font-size:clamp(24px,5vw,48px);letter-spacing:4px;color:#ffd700;text-shadow:0 0 25px #ffd700}
        #game-container{position:relative;width:100vw;height:100vh;max-width:600px;max-height:600px;display:flex;justify-content:center;align-items:center}
        canvas{width:100%;height:100%;max-width:600px;max-height:600px;background:#000;border-radius:15px;border:5px solid #ffd700;box-shadow:0 0 40px rgba(255,215,0,0.9)}
        #score{position:absolute;top:10px;left:50%;transform:translateX(-50%);font-size:clamp(18px,4vw,30px);color:#ffd700;background:rgba(0,0,0,0.8);padding:10px 20px;border-radius:30px;border:3px solid #ffd700;text-shadow:0 0 20px gold;z-index:20}
        #controls{position:absolute;bottom:20px;left:20px;right:20px;display:flex;justify-content:space-between;align-items:center;z-index:20}
        #joystick{width:80px;height:80px;background:rgba(255,255,255,0.1);border-radius:50%;position:relative;transition:transform 0.1s}
        #knob{width:40px;height:40px;background:#ffd700;border-radius:50%;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transition:transform 0.1s}
        #share-btn,#fullscreen-btn{padding:12px 20px;background:rgba(255,215,0,0.8);color:#000;border:none;border-radius:25px;font-family:'Orbitron';font-weight:700;cursor:pointer;transition:all 0.2s}
        #share-btn:hover,#fullscreen-btn:hover{background:#ffd700;transform:scale(1.05)}
        #start-screen,#game-over,#pause,#leaderboard{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.95);padding:40px 40px;border-radius:25px;text-align:center;border:4px solid #ffd700;box-shadow:0 0 60px rgba(255,215,0,0.8);font-size:clamp(24px,6vw,50px);color:#ffd700;text-shadow:0 0 25px #ffd700;z-index:30;max-width:90vw}
        #game-over{color:#ff3333;border-color:#ff3333;text-shadow:0 0 25px red}
        #pause{color:#00ff88;border-color:#00ff88;text-shadow:0 0 25px #00ff88}
        small{font-size:clamp(14px,3vw,24px);color:#fff;display:block;margin-top:20px}
        .rank{margin:8px 0;font-size:clamp(16px,4vw,28px)}
        @media (orientation:landscape) {#game-container{height:100vw;max-height:100vw}}
    </style>
</head>
<body>
    <h1>SNAKE üçå</h1>
    <div id="game-container">
        <canvas id="gameCanvas"></canvas>
        <div id="score">Muz: 0 | En Y√ºksek: 0</div>
        <div id="controls">
            <div id="joystick"><div id="knob"></div></div>
            <div>
                <button id="fullscreen-btn" title="F - Fullscreen">üì±</button>
                <button id="share-btn" title="Payla≈ü">üì§</button>
            </div>
        </div>
        
        <div id="start-screen">
            YILAN MUZ<br>
            <small>Joystick s√ºr√ºkle / SPACE ba≈üla</small>
        </div>
        <div id="game-over" style="display:none">
            OYUN Bƒ∞TTƒ∞!<br>
            <small>SPACE yeniden ba≈üla</small>
        </div>
        <div id="pause" style="display:none">
            PAUSE<br>
            <small>S√ºr√ºkle devam</small>
        </div>
        <div id="leaderboard" style="display:none">
            TOP 5<br>
            <div id="ranks"></div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const scoreEl = document.getElementById("score");
        const startScreen = document.getElementById("start-screen");
        const gameOverEl = document.getElementById("game-over");
        const pauseEl = document.getElementById("pause");
        const leaderboardEl = document.getElementById("leaderboard");
        const ranksEl = document.getElementById("ranks");
        const joystick = document.getElementById("joystick");
        const knob = document.getElementById("knob");
        const fullscreenBtn = document.getElementById("fullscreen-btn");
        const shareBtn = document.getElementById("share-btn");

        // Canvas resize
        function resizeCanvas() {
            const size = Math.min(window.innerWidth, window.innerHeight) * 0.9;
            canvas.width = size;
            canvas.height = size;
        }
        window.addEventListener("resize", resizeCanvas);
        resizeCanvas();

        const GRID = 30;
        let CELL = canvas.width / GRID;

        let snake = [{x:15,y:15},{x:14,y:15},{x:13,y:15},{x:12,y:15},{x:11,y:15}];
        let dx = 1, dy = 0;
        let food = {x:0, y:0, type: "normal"};
        let score = 0;
        let highScore = parseInt(localStorage.getItem("snakeHS")) || 0;
        let speed = 100;
        let gameRunning = false;
        let paused = false;
        let lastMove = 0;
        let audioCtx = null;

        // Joystick
        let joystickActive = false, joystickAngle = 0, joystickDistance = 0;
        joystick.addEventListener("touchstart", e => {
            joystickActive = true;
            e.preventDefault();
        });
        joystick.addEventListener("touchmove", e => {
            if (!joystickActive) return;
            const rect = joystick.getBoundingClientRect();
            const centerX = rect.left + rect.width / 2;
            const centerY = rect.top + rect.height / 2;
            const clientX = e.touches[0].clientX - centerX;
            const clientY = e.touches[0].clientY - centerY;
            joystickDistance = Math.min(25, Math.sqrt(clientX*clientX + clientY*clientY));
            joystickAngle = Math.atan2(clientY, clientX);
            knob.style.transform = `translate(-50%,-50%) translate(${Math.cos(joystickAngle)*joystickDistance}px,${Math.sin(joystickAngle)*joystickDistance}px)`;
            e.preventDefault();
        });
        joystick.addEventListener("touchend", e => {
            joystickActive = false;
            knob.style.transform = "translate(-50%,-50%)";
            e.preventDefault();
        });

        // Joystick y√∂n kontrol√º
        setInterval(() => {
            if (!gameRunning || paused || !joystickActive) return;
            if (joystickDistance > 15) {
                const angle = joystickAngle;
                if (Math.abs(Math.cos(angle)) > Math.abs(Math.sin(angle))) {
                    if (Math.cos(angle) > 0 && dx !== -1) {dx = 1; dy = 0;}
                    else if (Math.cos(angle) < 0 && dx !== 1) {dx = -1; dy = 0;}
                } else {
                    if (Math.sin(angle) > 0 && dy !== -1) {dx = 0; dy = 1;}
                    else if (Math.sin(angle) < 0 && dy !== 1) {dx = 0; dy = -1;}
                }
            }
        }, 100);

        // Fullscreen
        fullscreenBtn.addEventListener("click", () => {
            if (document.fullscreenElement) document.exitFullscreen();
            else document.documentElement.requestFullscreen();
        });

        // Share
        shareBtn.addEventListener("click", () => {
            if (navigator.share) {
                navigator.share({title: "Yƒ±lan Muz Skorum!", text: `Muz: ${score} | En Y√ºksek: ${highScore}`});
            } else {
                navigator.clipboard.writeText(`Yƒ±lan Muz Skorum: ${score}`);
                alert("Skor kopyalandƒ±!");
            }
        });

        // Vibration
        function vibrate(pattern = [100]) {
            if ("vibrate" in navigator) navigator.vibrate(pattern);
        }

        // Ses
        function playSound(freq, duration = 0.1) {
            if (!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.frequency.value = freq;
            osc.type = "sine";
            gain.gain.setValueAtTime(0.3, audioCtx.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + duration);
            osc.start(); osc.stop(audioCtx.currentTime + duration);
        }

        function spawnFood(){
            do { food.x = Math.floor(Math.random()*GRID); food.y = Math.floor(Math.random()*GRID); }
            while(snake.some(p=>p.x===food.x && p.y===food.y));
            const rand = Math.random();
            food.type = rand < 0.1 ? "golden" : rand < 0.2 ? "red" : "normal";
        }

        function startGame(){
            gameRunning = true; paused = false;
            startScreen.style.display = "none";
            pauseEl.style.display = "none";
            gameOverEl.style.display = "none";
            leaderboardEl.style.display = "none";
            score = 0; speed = 100;
            snake = [{x:15,y:15},{x:14,y:15},{x:13,y:15},{x
